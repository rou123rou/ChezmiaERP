<h2>Ajouter un nouveau client</h2>

<form (ngSubmit)="addClient()" #addClientForm="ngForm" class="client-form">
  <mat-form-field appearance="outline">
    <mat-label>Nom</mat-label>
    <input matInput id="nom" name="nom" [(ngModel)]="newClient.nom" required>
  </mat-form-field>
  <mat-form-field appearance="outline">
    <mat-label>Prénom</mat-label>
    <input matInput id="prenom" name="prenom" [(ngModel)]="newClient.prenom">
  </mat-form-field>
  <mat-form-field appearance="outline">
    <mat-label>Email</mat-label>
    <input matInput id="email" name="email" [(ngModel)]="newClient.email" required email>
  </mat-form-field>
  <mat-form-field appearance="outline">
    <mat-label>Téléphone</mat-label>
    <input matInput id="telephone" name="telephone" [(ngModel)]="newClient.telephone">
  </mat-form-field>
  <h3>Adresse</h3>
  <div class="adresse-form">
    <mat-form-field appearance="outline">
      <mat-label>Rue</mat-label>
      <input matInput id="rue" name="rue" [(ngModel)]="newClient.adresse.rue">
    </mat-form-field>
    <mat-form-field appearance="outline">
      <mat-label>Ville</mat-label>
      <input matInput id="ville" name="ville" [(ngModel)]="newClient.adresse.ville">
    </mat-form-field>
    <mat-form-field appearance="outline">
      <mat-label>Code Postal</mat-label>
      <input matInput id="codePostal" name="codePostal" [(ngModel)]="newClient.adresse.codePostal">
    </mat-form-field>
    <mat-form-field appearance="outline">
      <mat-label>Pays</mat-label>
      <input matInput id="pays" name="pays" [(ngModel)]="newClient.adresse.pays">
    </mat-form-field>
  </div>
  <button mat-raised-button color="primary" type="submit" [disabled]="!addClientForm.form.valid">Ajouter</button>
</form>

<hr>

<h2>Liste des Clients</h2>

<div *ngIf="errorMessage" class="error-message">
  {{ errorMessage }}
</div>

<mat-card *ngIf="clients.length > 0">
  <mat-list>
    <mat-list-item *ngFor="let client of clients">
      <h3 matListItemTitle>{{ client.nom }}  {{ client.prenom }}<button mat-button color="warn" (click)="deleteClient(client._id)">
        Supprimer
      </button></h3> 
      <p matListItemLine>{{ client.email }} <button mat-button color="accent" (click)="editClient(client)">
        Modifier
      </button></p>
      
      
    </mat-list-item>
  </mat-list>
</mat-card>

<p *ngIf="clients.length === 0 && !errorMessage">
  Aucun client trouvé.
</p>

<div *ngIf="editingClient" class="edit-form">
  <h2>Modifier le Client</h2>
  <form (ngSubmit)="updateClient()" #editClientForm="ngForm" class="client-form">
    <mat-form-field appearance="outline">
      <mat-label>Nom</mat-label>
      <input matInput id="editNom" name="editNom" [(ngModel)]="editingClient.nom" required>
    </mat-form-field>
    <mat-form-field appearance="outline">
      <mat-label>Prénom</mat-label>
      <input matInput id="editPrenom" name="editPrenom" [(ngModel)]="editingClient.prenom">
    </mat-form-field>
    <mat-form-field appearance="outline">
      <mat-label>Email</mat-label>
      <input matInput id="editEmail" name="editEmail" [(ngModel)]="editingClient.email" required email>
    </mat-form-field>
    <mat-form-field appearance="outline">
      <mat-label>Téléphone</mat-label>
      <input matInput id="editTelephone" name="editTelephone" [(ngModel)]="editingClient.telephone">
    </mat-form-field>
    <h3>Adresse</h3>
    <div class="adresse-form">
      <mat-form-field appearance="outline">
        <mat-label>Rue</mat-label>
        <input matInput id="editRue" name="editRue" [(ngModel)]="editingClient.adresse.rue">
      </mat-form-field>
      <mat-form-field appearance="outline">
        <mat-label>Ville</mat-label>
        <input matInput id="editVille" name="editVille" [(ngModel)]="editingClient.adresse.ville">
      </mat-form-field>
      <mat-form-field appearance="outline">
        <mat-label>Code Postal</mat-label>
        <input matInput id="editCodePostal" name="editCodePostal" [(ngModel)]="editingClient.adresse.codePostal">
      </mat-form-field>
      <mat-form-field appearance="outline">
        <mat-label>Pays</mat-label>
        <input matInput id="editPays" name="editPays" [(ngModel)]="editingClient.adresse.pays">
      </mat-form-field>
    </div>
    <div class="actions">
      <button mat-raised-button color="primary" type="submit" [disabled]="!editClientForm.form.valid">Enregistrer</button>
      <button mat-button type="button" (click)="cancelEdit()">Annuler</button>
    </div>
  </form>
</div>